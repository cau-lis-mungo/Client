<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>대출하기</title>

  <link rel="stylesheet" href="/Css/font.css" />
  <link rel="stylesheet" href="/Css/Loan.css" />

</head>

<body>
  <div class="container">
    <div class="top-bar">
    <div class="back-btn" onclick="location.href='loan_choice.html'">←</div>
    <h1 class = "sun-title">대출하기</h1>
  </div>
    <!-- <div class ="sub-title">
        대출하기
      </div> -->
    <img src="/Images/navigation2.png" alt="로고" class="logo" />

    <form id="loan-form" method="POST" action="/loan">
      
      <div class ="form-group">
        <input
            type="text"
            id="registerNumber"
            class="number-input"
            value="MJ"
            inputmode="numeric" 
            autocomplete="off"
            required
        />
        <p class="input-guide">예시: MJ123456 (숫자 6자리만 입력)</p>
      </div>
      <button type="submit" class="submit-btn">대출하기</button>
    </form>
    <div class ="caption">
      ※ 대출기간은 7일이며, 대출 연장은 1회에 한해 7일까지 가능합니다(최종 14일).<br>
      ※ 대출 예약을 한 경우, 대기 제한이 없을 시 3일 내 대출해야 합니다.<br>
      ※ 연속 대출은 예약자가 있는 경우에는 불가능하며, 없는 경우에도 3일이 지나야 가능합니다.<br>
      ※ 연체 시 연체일 만큼 대출이 금지됩니다.
    </div>

  <script>
    const input = document.getElementById('registerNumber');
    const PREFIX = 'MJ';

    // 처음에는 항상 MJ로 시작
    input.value = PREFIX;

    input.addEventListener('input', () => {
      if (!input.value.startsWith(PREFIX)) {
        input.value = PREFIX;
      }

      // MJ 이후 문자열만 추출
      let suffix = input.value.slice(PREFIX.length);

      // 숫자만 허용 (문자 제거)
      suffix = suffix.replace(/\D/g, '');

      // 6자리까지만 유지
      if (suffix.length > 6) {
        suffix = suffix.slice(0, 6);
      }

      // 다시 입력창에 반영
      input.value = PREFIX + suffix;
    });

    input.addEventListener('keydown', function (e) {
      // 백스페이스로 MJ 지우지 못하게 막음
      if (
        (input.selectionStart <= PREFIX.length && e.key === 'Backspace') ||
        (input.selectionStart < PREFIX.length && e.key.length === 1)
      ) {
        e.preventDefault();
      }
    });

    document.getElementById('loan-form').addEventListener('submit', function (e) {
      const full = input.value.trim();
      const suffix = full.slice(PREFIX.length);

      if (!/^\d{6}$/.test(suffix)) {
        alert('숫자 6자리를 정확히 입력해주세요.');
        e.preventDefault();
      }
    });

  </script>
</body>
</html>
